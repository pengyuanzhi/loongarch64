/**
 * @file    arch_signal.S
 * @brief   信号处理汇编实现
 * @author  Intewell Team
 * @date    2025-01-22
 * @version 1.0
 *
 * @details 本文件实现 LoongArch64 架构的信号处理相关汇编函数
 *          - 信号返回代码片段（sigreturn_code）
 *          - 系统调用封装（rt_sigreturn）
 *
 * @note MISRA-C:2012 合规
 * @warning 此代码片段由内核直接调用
 *
 * @copyright Copyright (c) 2025 Intewell Team
 */

/*************************** 修改历史 ****************************/
/*
 * 修改历史：
 * 2025-01-22    Intewell Team
 *               创建该文件
 */

/*************************** 头文件包含 ****************************/
#define ASM_USE
#include <syscall.h>
#include <asm.h>

/*************************** 宏定义 ****************************/


/*************************** 类型定义 ****************************/


/*************************** 外部声明 ****************************/


/*************************** 前向声明 ****************************/


/*************************** 模块变量 ****************************/


/*************************** 函数实现 ****************************/

/**
 * @brief 信号返回代码片段
 *
 * @details 用于信号处理返回的汇编代码片段
 *          执行流程：
 *          1. 设置系统调用号（__NR_rt_sigreturn）
 *          2. 执行系统调用（syscall 0）
 *          3. 返回到用户空间
 *
 * @note 此代码片段直接执行系统调用，不从函数返回
 * @note 由内核在信号处理完成后跳转到此代码
 * @note 执行 syscall 后将恢复信号前的上下文
 */
    .text
    .align  5
ENTRY(sigreturn_code)
    li.d     a7, __NR_rt_sigreturn    /* 设置系统调用号：rt_sigreturn */
    syscall  0                        /* 执行系统调用 */
ENDPROC(sigreturn_code)
