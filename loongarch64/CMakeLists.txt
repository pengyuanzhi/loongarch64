string(REGEX REPLACE "/$" "" CURRENT_FOLDER_ABSOLUTE ${CMAKE_CURRENT_SOURCE_DIR})

file(GLOB SOURCE_FILE_LIST ${CURRENT_FOLDER_ABSOLUTE}/*.c ${CURRENT_FOLDER_ABSOLUTE}/*.S ${CURRENT_FOLDER_ABSOLUTE}/*.cpp ${CURRENT_FOLDER_ABSOLUTE}/*.cxx ${CURRENT_FOLDER_ABSOLUTE}/*.c++)

foreach(file ${SOURCE_FILE_LIST})
    list(APPEND GLOB_SOURCE_LIST ${file})
endforeach()

#asm-offsets.c仅用作生成asm-offsets.h,不参与内核编译
REMOVE_SRC (GLOB_SOURCE_LIST asm-offsets.c)

# 包含子文件夹
SUBDIRLIST(SUBDIRS)

foreach(SUB_FOLDER ${SUBDIRS})
    ADD_SUBDIR(${SUB_FOLDER})
endforeach()

set(GLOB_LINKSCRIPT ${CURRENT_FOLDER_ABSOLUTE}/link.lds)

set(GLOB_INC_PATH_LIST ${GLOB_INC_PATH_LIST} PARENT_SCOPE)
set(GLOB_SOURCE_LIST ${GLOB_SOURCE_LIST} PARENT_SCOPE)
set(GLOB_LINKSCRIPT ${GLOB_LINKSCRIPT} PARENT_SCOPE)
